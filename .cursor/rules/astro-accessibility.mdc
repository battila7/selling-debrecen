---
description: "Astro Accessibility"
---
# Astro Accessibility (a11y)

Best practices for building accessible Astro applications.

<rule>
name: astro_accessibility
description: Standards for accessibility in Astro components and pages
filters:
  - type: file_extension
    pattern: "\\.astro$"

actions:
  - type: suggest
    message: |
      Follow these accessibility best practices for Astro:

      ## Semantic HTML

      ### Use Proper Elements
      ```astro
      <!-- ✅ GOOD: Semantic HTML -->
      <nav aria-label="Main navigation">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/about">About</a></li>
        </ul>
      </nav>
      
      <main>
        <article>
          <h1>Article Title</h1>
          <p>Content...</p>
        </article>
      </main>
      
      <aside aria-label="Sidebar">
        <h2>Related Content</h2>
      </aside>
      
      <!-- ❌ BAD: Generic divs without semantics -->
      <div class="nav">
        <div class="link">Home</div>
      </div>
      ```

      ### Heading Hierarchy
      ```astro
      <!-- ✅ GOOD: Proper heading order -->
      <h1>Page Title</h1>
      <section>
        <h2>Section Title</h2>
        <h3>Subsection</h3>
      </section>
      
      <!-- ❌ BAD: Skipping levels -->
      <h1>Page Title</h1>
      <h4>Wrong Level</h4>
      ```

      ## ARIA Attributes

      ### Landmarks
      ```astro
      <header role="banner">
        <nav aria-label="Main navigation">...</nav>
      </header>
      
      <main role="main" id="main-content">
        <h1>Main Content</h1>
      </main>
      
      <aside role="complementary" aria-label="Sidebar">
        <h2>Related</h2>
      </aside>
      
      <footer role="contentinfo">
        <p>&copy; 2024</p>
      </footer>
      ```

      ### Skip Links
      ```astro
      <a href="#main-content" class="skip-link">
        Skip to main content
      </a>
      
      <style>
        .skip-link {
          position: absolute;
          top: -40px;
          left: 0;
          background: #000;
          color: #fff;
          padding: 8px;
          z-index: 100;
        }
        
        .skip-link:focus {
          top: 0;
        }
      </style>
      ```

      ### Interactive Elements
      ```astro
      <!-- ✅ GOOD: Button with proper attributes -->
      <button
        type="button"
        aria-label="Close modal"
        aria-expanded="false"
        aria-controls="modal-content"
      >
        <span aria-hidden="true">&times;</span>
      </button>
      
      <!-- ✅ GOOD: Toggle with state -->
      <button
        type="button"
        aria-pressed={isActive}
        aria-label={isActive ? 'Deactivate' : 'Activate'}
      >
        Toggle
      </button>
      ```

      ## Forms

      ### Accessible Form Fields
      ```astro
      <form>
        <!-- ✅ GOOD: Label with input -->
        <div>
          <label for="email">Email Address</label>
          <input
            type="email"
            id="email"
            name="email"
            required
            aria-required="true"
            aria-describedby="email-help"
          />
          <small id="email-help">
            We'll never share your email
          </small>
        </div>
        
        <!-- ✅ GOOD: Error messages -->
        <div>
          <label for="password">Password</label>
          <input
            type="password"
            id="password"
            name="password"
            aria-invalid={hasError}
            aria-describedby={hasError ? 'password-error' : undefined}
          />
          {hasError && (
            <span id="password-error" role="alert">
              Password must be at least 8 characters
            </span>
          )}
        </div>
        
        <!-- ✅ GOOD: Fieldset for groups -->
        <fieldset>
          <legend>Contact Preferences</legend>
          <label>
            <input type="checkbox" name="newsletter" />
            Email newsletter
          </label>
          <label>
            <input type="checkbox" name="updates" />
            Product updates
          </label>
        </fieldset>
        
        <button type="submit">Submit</button>
      </form>
      ```

      ### Custom Form Controls
      ```astro
      ---
      interface Props {
        options: Array<{ value: string; label: string }>;
        value: string;
      }
      
      const { options, value } = Astro.props;
      ---
      
      <!-- Custom select with proper ARIA -->
      <div class="custom-select">
        <button
          type="button"
          aria-haspopup="listbox"
          aria-expanded="false"
          aria-labelledby="select-label"
          id="select-button"
        >
          {value}
        </button>
        
        <ul
          role="listbox"
          aria-labelledby="select-label"
          hidden
        >
          {options.map((option, index) => (
            <li
              role="option"
              aria-selected={option.value === value}
              id={`option-${index}`}
            >
              {option.label}
            </li>
          ))}
        </ul>
      </div>
      ```

      ## Images

      ### Alt Text
      ```astro
      ---
      import { Image } from 'astro:assets';
      import productImage from '../assets/product.jpg';
      ---
      
      <!-- ✅ GOOD: Descriptive alt text -->
      <Image
        src={productImage}
        alt="Red leather wallet with brass zipper and 6 card slots"
      />
      
      <!-- ✅ GOOD: Decorative image -->
      <Image
        src={decorativeImage}
        alt=""
        role="presentation"
      />
      
      <!-- ❌ BAD: Missing or poor alt text -->
      <Image src={productImage} alt="product" />
      <img src="image.jpg" />
      ```

      ### Complex Images
      ```astro
      <!-- ✅ GOOD: Figure with caption -->
      <figure>
        <Image src={chartImage} alt="Bar chart showing sales growth" />
        <figcaption>
          Sales increased by 45% in Q4 2024, with the highest growth
          in the Northeast region at 62%.
        </figcaption>
      </figure>
      
      <!-- ✅ GOOD: Image with long description -->
      <Image
        src={infographic}
        alt="Customer satisfaction survey results"
        aria-describedby="infographic-desc"
      />
      <div id="infographic-desc" class="sr-only">
        Detailed description: 92% of customers rated us 4 or 5 stars...
      </div>
      ```

      ## Focus Management

      ### Visible Focus Indicators
      ```astro
      <style>
        /* ✅ GOOD: Visible focus styles */
        a:focus,
        button:focus,
        input:focus {
          outline: 2px solid #0066cc;
          outline-offset: 2px;
        }
        
        /* ❌ BAD: Removing focus outline without alternative */
        *:focus {
          outline: none;
        }
      </style>
      ```

      ### Focus Trapping in Modals
      ```astro
      ---
      // components/Modal.astro
      interface Props {
        isOpen: boolean;
        title: string;
      }
      
      const { isOpen, title } = Astro.props;
      ---
      
      {isOpen && (
        <div
          role="dialog"
          aria-modal="true"
          aria-labelledby="modal-title"
          class="modal"
        >
          <div class="modal-content">
            <h2 id="modal-title">{title}</h2>
            
            <slot />
            
            <button type="button" aria-label="Close modal">
              Close
            </button>
          </div>
        </div>
      )}
      
      <script>
        // Trap focus within modal when open
        const modal = document.querySelector('[role="dialog"]');
        if (modal) {
          const focusableElements = modal.querySelectorAll(
            'a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])'
          );
          const firstElement = focusableElements[0] as HTMLElement;
          const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;
          
          firstElement?.focus();
          
          modal.addEventListener('keydown', (e) => {
            if (e.key === 'Tab') {
              if (e.shiftKey && document.activeElement === firstElement) {
                e.preventDefault();
                lastElement?.focus();
              } else if (!e.shiftKey && document.activeElement === lastElement) {
                e.preventDefault();
                firstElement?.focus();
              }
            }
          });
        }
      </script>
      ```

      ## Color and Contrast

      ### Sufficient Contrast
      ```astro
      <style>
        /* ✅ GOOD: WCAG AA compliant (4.5:1 for normal text) */
        .text-primary {
          color: #2c5282; /* on white background */
        }
        
        /* ✅ GOOD: WCAG AAA compliant (7:1 for normal text) */
        .text-high-contrast {
          color: #1a365d; /* on white background */
        }
        
        /* ❌ BAD: Insufficient contrast */
        .text-low-contrast {
          color: #cbd5e0; /* on white background - fails WCAG */
        }
      </style>
      ```

      ### Don't Rely on Color Alone
      ```astro
      <!-- ✅ GOOD: Multiple indicators -->
      <button class="button-success">
        <svg aria-hidden="true">
          <use href="#check-icon" />
        </svg>
        <span>Success</span>
      </button>
      
      <!-- Form validation -->
      <input
        type="email"
        aria-invalid={hasError}
        class:list={['input', { 'input-error': hasError }]}
      />
      {hasError && (
        <span class="error-message" role="alert">
          <svg aria-hidden="true">
            <use href="#error-icon" />
          </svg>
          Invalid email address
        </span>
      )}
      ```

      ## Motion and Animation

      ### Respect Reduced Motion Preference
      ```astro
      <style>
        /* ✅ GOOD: Respect user preferences */
        .animated {
          animation: slide-in 0.3s ease-out;
        }
        
        @media (prefers-reduced-motion: reduce) {
          .animated {
            animation: none;
            transition: none;
          }
        }
      </style>
      ```

      ## Screen Reader Support

      ### Screen Reader Only Text
      ```astro
      <style>
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }
      </style>
      
      <button>
        <svg aria-hidden="true">
          <use href="#search-icon" />
        </svg>
        <span class="sr-only">Search</span>
      </button>
      ```

      ### Live Regions
      ```astro
      <!-- ✅ GOOD: Announce dynamic changes -->
      <div
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        {statusMessage}
      </div>
      
      <!-- For urgent announcements -->
      <div
        role="alert"
        aria-live="assertive"
      >
        {errorMessage}
      </div>
      ```

      ## Keyboard Navigation

      ### Keyboard-Accessible Components
      ```astro
      <!-- ✅ GOOD: Keyboard accessible tabs -->
      <div class="tabs">
        <div role="tablist" aria-label="Content sections">
          <button
            role="tab"
            aria-selected="true"
            aria-controls="panel-1"
            id="tab-1"
            tabindex="0"
          >
            Tab 1
          </button>
          <button
            role="tab"
            aria-selected="false"
            aria-controls="panel-2"
            id="tab-2"
            tabindex="-1"
          >
            Tab 2
          </button>
        </div>
        
        <div
          role="tabpanel"
          id="panel-1"
          aria-labelledby="tab-1"
          tabindex="0"
        >
          <p>Content 1</p>
        </div>
      </div>
      
      <script>
        // Handle arrow key navigation
        const tablist = document.querySelector('[role="tablist"]');
        const tabs = tablist?.querySelectorAll('[role="tab"]');
        
        tabs?.forEach((tab, index) => {
          tab.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') {
              const nextTab = tabs[(index + 1) % tabs.length] as HTMLElement;
              nextTab.focus();
              nextTab.click();
            } else if (e.key === 'ArrowLeft') {
              const prevTab = tabs[(index - 1 + tabs.length) % tabs.length] as HTMLElement;
              prevTab.focus();
              prevTab.click();
            }
          });
        });
      </script>
      ```

      ## Testing Accessibility

      ### Automated Testing
      ```javascript
      // package.json
      {
        "scripts": {
          "test:a11y": "pa11y-ci"
        },
        "devDependencies": {
          "pa11y-ci": "^3.0.1"
        }
      }
      ```

      ### Manual Testing Checklist
      ```astro
      <!--
        Accessibility Testing Checklist:
        
        [ ] Keyboard navigation works for all interactive elements
        [ ] Focus indicators are visible
        [ ] Screen reader announces content correctly
        [ ] Color contrast meets WCAG AA (4.5:1)
        [ ] Images have appropriate alt text
        [ ] Forms have labels and error messages
        [ ] Heading hierarchy is logical
        [ ] ARIA attributes are used correctly
        [ ] Motion respects prefers-reduced-motion
        [ ] Content is readable at 200% zoom
      -->
      ```

examples:
  - input: |
      # Bad: Inaccessible
      <div class="nav">
        <div onclick="navigate()">Home</div>
      </div>
      <img src="img.jpg" />
      
      # Good: Accessible
      <nav aria-label="Main navigation">
        <ul>
          <li><a href="/">Home</a></li>
        </ul>
      </nav>
      <Image src={img} alt="Descriptive text" />
    output: "Accessible Astro component"
</rule>
