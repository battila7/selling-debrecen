---
import House from "@lucide/astro/icons/house";
import MapPin from "@lucide/astro/icons/map-pin";
import Maximize2 from "@lucide/astro/icons/maximize-2";

export interface Listing {
  title: string;
  address: string;
  price: string;
  image?: string;
  imageAlt?: string;
  link?: string;
  rooms?: number;
  area?: number;
  propertyType?: string;
  listingType?: string;
  description?: string;
}

interface Props {
  listing: Listing;
}

const { listing } = Astro.props;
---

<article
  class="bg-cream-soft border-2 border-taupe/30 transition-all duration-700 hover:border-navy/40 group"
>
  <!-- Image Section -->
  <a
    href={listing.link ?? "#"}
    class="block relative overflow-hidden aspect-[16/10]"
  >
    {
      listing.image && (
        <img
          src={listing.image}
          alt={listing.imageAlt ?? listing.title}
          class="w-full h-full object-cover transition-transform duration-1000 ease-out group-hover:scale-105"
        />
      )
    }

    <!-- Badges Container -->
    <div class="absolute top-0 left-0">
      <div class="bg-navy px-4 py-2 flex flex-row gap-2 items-center">
        <span
          class="font-geometric-humanist text-xs text-cream tracking-widest uppercase font-semibold"
        >
          {listing.listingType}
        </span>
        <span
          class="font-geometric-humanist text-xs text-cream tracking-widest uppercase font-semibold"
        >
          {listing.propertyType}
        </span>
      </div>
    </div>
  </a>

  <!-- Content Section -->
  <div class="p-5">
    <!-- Title and Address -->
    <a href={listing.link ?? "#"} class="block mb-4">
      <h3
        class="font-old-style text-xl text-charcoal mb-2 tracking-wide transition-colors duration-500 group-hover:text-navy"
      >
        {listing.title}
      </h3>
      <div class="flex items-start gap-2 text-charcoal/70">
        <MapPin size={16} class="mt-0.5 flex-shrink-0" />
        <p class="font-geometric-humanist text-sm tracking-wide">
          {listing.address}
        </p>
      </div>
    </a>

    <!-- Divider -->
    <div class="border-t border-taupe/40 mb-4"></div>

    <!-- Property Details Grid -->
    <div class="grid grid-cols-2 gap-4 mb-4">
      {
        listing.rooms !== undefined && (
          <div class="flex items-center gap-2.5">
            <div class="bg-taupe/20 p-2">
              <House size={20} class="text-navy" />
            </div>
            <div>
              <p class="font-geometric-humanist text-xs text-charcoal/60 uppercase tracking-wider">
                Szobák
              </p>
              <p class="font-old-style text-lg text-charcoal font-semibold">
                {listing.rooms}
              </p>
            </div>
          </div>
        )
      }

      {
        listing.area !== undefined && (
          <div class="flex items-center gap-2.5">
            <div class="bg-taupe/20 p-2">
              <Maximize2 size={20} class="text-navy" />
            </div>
            <div>
              <p class="font-geometric-humanist text-xs text-charcoal/60 uppercase tracking-wider">
                Terület
              </p>
              <p class="font-old-style text-lg text-charcoal font-semibold">
                {listing.area} m²
              </p>
            </div>
          </div>
        )
      }
    </div>

    <!-- Description (if available) -->
    {
      listing.description && (
        <p class="font-system-ui text-sm text-charcoal/70 leading-relaxed mb-4 line-clamp-2">
          {listing.description}
        </p>
      )
    }

    <!-- Divider -->
    <div class="border-t border-taupe/40 mb-4"></div>

    <!-- Price and CTA -->
    <div class="flex items-center justify-between">
      <div>
        <p
          class="font-geometric-humanist text-xs text-charcoal/60 uppercase tracking-wider mb-1"
        >
          Ár
        </p>
        <p class="font-old-style text-2xl text-navy font-bold tracking-wide">
          {listing.price}
        </p>
      </div>

      <a
        href={listing.link ?? "#"}
        class="inline-block px-5 py-2.5 bg-navy text-cream font-geometric-humanist text-xs tracking-widest uppercase font-semibold border-2 border-navy hover:bg-transparent hover:text-navy transition-colors duration-700"
      >
        Részletek
      </a>
    </div>
  </div>
</article>
