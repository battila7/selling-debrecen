---
import Links from "../../../util/links";
import SellingDebrecenLogo from "../../../images/selling-debrecen-logo.svg";
---

<style>
  @media (width >= 40rem) {
    .push-to-the-right {
      translate: calc(20rem - 100% - var(--spacing) * 6) 0;
    }
  }

  @media (width >= 48rem) {
    .push-to-the-right {
      translate: calc(24rem - 100% - var(--spacing) * 6) 0;
    }
  }

  @media (width >= 64rem) {
    .push-to-the-right {
      translate: calc(32rem - 100% - var(--spacing) * 12) 0;
    }
  }

  @media (width >= 80rem) {
    .push-to-the-right {
      translate: calc(40rem - 100% - var(--spacing) * 12) 0;
    }
  }

  @media (width >= 96rem) {
    .push-to-the-right {
      translate: calc(48rem - 100% - var(--spacing) * 12) 0;
    }
  }
</style>

<header
  id="hero-header"
  class="hidden md:block relative transition-all duration-300 z-50 bg-navy/80 backdrop-blur-sm border-b border-camel/70"
>
  <nav class="container mx-auto px-6 lg:px-12 py-4">
    <div
      class="relative hidden md:flex items-center justify-between transition-all duration-500 ease-in-out"
    >
      <a
        href={Links.HOME}
        id="logo-link"
        class="opacity-0 text-white text-xl flex items-center gap-4 transition-opacity duration-500"
      >
        <SellingDebrecenLogo class="h-10 md:h-10 text-white inline-block" />
        <span class="text-white text-lg">Selling Debrecen</span>
      </a>

      <div
        id="nav-links"
        class="text-sm absolute left-[50%] translate-x-[-50%] flex items-center gap-8 mx-auto transition-all duration-500"
      >
        <a
          href={Links.PROPERTIES}
          class="text-white hover:text-gray-300 transition-colors text-md"
        >
          Ingatlanjaink
        </a>
        <a
          href={Links.FOR_SELLERS}
          class="text-white hover:text-gray-300 transition-colors text-md"
        >
          Kínálóknak
        </a>
        <a
          href={Links.FOR_BUYERS}
          class="text-white hover:text-gray-300 transition-colors text-md"
        >
          Keresőknek
        </a>
        <a
          href={Links.ABOUT}
          class="text-white hover:text-gray-300 transition-colors text-md"
        >
          Rólunk
        </a>
        <a
          href={Links.SCHEDULE}
          class="bg-white text-charcoal px-4 py-2 rounded hover:bg-gray-100 transition-colors text-md"
        >
          Időpontfoglalás
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const heroHeader = document.getElementById("hero-header");
    const logoLink = document.getElementById("logo-link");
    const navLinks = document.getElementById("nav-links");

    if (!heroHeader || !logoLink || !navLinks) return;

    let stickyPoint: number | null = null;
    let isSticky = false;

    const updateStickyState = () => {
      // Calculate the sticky point on first scroll or if not set
      if (stickyPoint === null) {
        const headerRect = heroHeader.getBoundingClientRect();
        const scrollTop =
          window.pageYOffset || document.documentElement.scrollTop;
        stickyPoint = headerRect.top + scrollTop;
      }

      const scrollTop =
        window.pageYOffset || document.documentElement.scrollTop;
      const shouldBeSticky = scrollTop >= (stickyPoint ?? 0);

      // Only update if state changed
      if (shouldBeSticky !== isSticky) {
        isSticky = shouldBeSticky;

        if (isSticky) {
          heroHeader.classList.remove("relative");
          heroHeader.classList.add("fixed", "top-0", "left-0", "right-0");
          logoLink.classList.remove("opacity-0");
          logoLink.classList.add("opacity-100");
          navLinks.classList.remove("translate-x-[-50%]");
          navLinks.classList.add("push-to-the-right");
        } else {
          heroHeader.classList.remove("fixed", "top-0", "left-0", "right-0");
          heroHeader.classList.add("relative");
          logoLink.classList.remove("opacity-100");
          logoLink.classList.add("opacity-0");
          navLinks.classList.remove("push-to-the-right");
          navLinks.classList.add("translate-x-[-50%]");
        }
      }
    };

    window.addEventListener("scroll", updateStickyState, { passive: true });

    // Initial check
    updateStickyState();
  });
</script>
